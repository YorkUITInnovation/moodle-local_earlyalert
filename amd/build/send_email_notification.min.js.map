{"version":3,"file":"send_email_notification.min.js","sources":["../src/send_email_notification.js"],"sourcesContent":["import notification from 'core/notification';\nimport ajax from 'core/ajax';\nimport {get_string as getString} from 'core/str';\n\nexport const init = () => {\n    sendEmails();\n};\n\n/**\n * Send email\n */\nfunction sendEmails() {\n    // Get button by class early-alert-send-button\n\n    document.querySelectorAll('.early-alert-send-button').forEach(button => {\n        button.addEventListener('click', function () {\n            // Get value from element with id early_alert_filter_course_id\n            var course_id = document.getElementById('early_alert_filter_course_id').value;\n            var alert_type = document.getElementById('early-alert-alert-type').value;\n            var course_name = document.getElementById('early_alert_course_name').value;\n\n            // Get all checked checkboxes fromelement with class early_alert_course_name and add to array called ids\n            var ids = [];\n            document.querySelectorAll('.early_alert_course_name').forEach(checkbox => {\n                if (checkbox.checked) {\n                    ids.push(checkbox.value);\n                }\n            });\n\n            var send_string = getString('send_email', 'local_earlyalert');\n            var send_dialog_text = getString('send_dialog_text', 'local_earlyalert');\n            var send = getString('send', 'local_earlyalert');\n            var cancel = getString('cancel', 'local_earlyalert');\n            var sent_email = getString('sent_email', 'local_earlyalert');\n            var could_not_send_email = getString('could_not_send_email', 'local_earlyalert');\n            var sent_dialog_text = getString('sent_dialog_text', 'local_earlyalert');\n\n            // Notification\n            notification.confirm(send_string, send_dialog_text, send, cancel, function () {\n                // Delete the record\n                var sendEmail = ajax.call([{\n                    methodname: 'earlyalert_report_log_insert',\n                    args: {\n                        id: ids,\n                    }\n                }]);\n                sendEmail[0].done(function () {\n                    // success\n                    notification.alert(sent_email);\n                }).fail(function () {\n                    //notification.alert(could_not_send_email);\n                    notification.alert(sent_dialog_text);\n                });\n            });\n        });\n    });\n\n}"],"names":["document","querySelectorAll","forEach","button","addEventListener","getElementById","value","ids","checkbox","checked","push","send_string","send_dialog_text","send","cancel","sent_email","sent_dialog_text","confirm","ajax","call","methodname","args","id","done","alert","fail"],"mappings":"2ZAIoB,KAUhBA,SAASC,iBAAiB,4BAA4BC,SAAQC,SAC1DA,OAAOC,iBAAiB,SAAS,WAEbJ,SAASK,eAAe,gCAAgCC,MACvDN,SAASK,eAAe,0BAA0BC,MACjDN,SAASK,eAAe,2BAA2BC,UAGjEC,IAAM,GACVP,SAASC,iBAAiB,4BAA4BC,SAAQM,WACtDA,SAASC,SACTF,IAAIG,KAAKF,SAASF,cAItBK,aAAc,mBAAU,aAAc,oBACtCC,kBAAmB,mBAAU,mBAAoB,oBACjDC,MAAO,mBAAU,OAAQ,oBACzBC,QAAS,mBAAU,SAAU,oBAC7BC,YAAa,mBAAU,aAAc,oBAErCC,mBADuB,mBAAU,uBAAwB,qBACtC,mBAAU,mBAAoB,2CAGxCC,QAAQN,YAAaC,iBAAkBC,KAAMC,QAAQ,WAE9CI,cAAKC,KAAK,CAAC,CACvBC,WAAY,+BACZC,KAAM,CACFC,GAAIf,QAGF,GAAGgB,MAAK,iCAEDC,MAAMT,eACpBU,MAAK,iCAESD,MAAMR"}