{"version":3,"file":"filter_students_grade.min.js","sources":["../src/filter_students_grade.js"],"sourcesContent":["import ajax from 'core/ajax';\nexport const init = () => {\n    filter_students_by_grade();\n};\n\n/**\n * Adds students with grades\n */\nfunction filter_students_by_grade() {\n\n    // Get the s delected grade value from the dropdown\n    const selected_grade = document.getElementById('id_early_alert_filter_grade_select');\n    let $grade_letter_id = selected_grade.value;\n    const course_id = document.getElementsByName('early_alert_filter_course_id')[0].value;\n\n    setup_filter_students_by_grade(course_id, $grade_letter_id);\n\n    selected_grade.addEventListener('change', function() {\n        $grade_letter_id = selected_grade.value;\n        setup_filter_students_by_grade(course_id, $grade_letter_id);\n    });\n\n}\n\n/**\n *  Filter your data based on the selected grade value (for example)\n * @param course_id\n * @param $grade_letter_id\n */\nfunction setup_filter_students_by_grade(course_id, $grade_letter_id) {\n    let selected_students = [];\n\n    var get_filtered_studentgrades = ajax.call([{\n        methodname: 'earlyalert_course_grades_percent_get',\n        args: {\n            id: course_id,\n            grade_letter_id: $grade_letter_id\n        }\n    }]);\n    get_filtered_studentgrades[0].done(function (results) {\n        //results.filter(item => item.grade === parseInt(selectedGrade));\n        //let t = selectedGrade;\n        // Update your page with the filtered data\n\n        const students_gradesList = document.getElementById('early_alert_filter_students_container');\n        students_gradesList.innerHTML = '';\n        const ulElement = document.createElement('ul');\n\n        let select_all_checkbox = document.createElement('INPUT');\n        select_all_checkbox.type = 'checkbox';\n        select_all_checkbox.className = 'early_alert_filterform_select_all_checkbox';\n        select_all_checkbox.id = 'early_alert_filterform_select_all_checkbox_0';\n\n        let select_all_li = document.createElement('LI');\n\n        // Create a label for the select allcheckbox\n        let select_all_label = document.createElement('LABEL');\n        select_all_label.textContent = 'Select All/None';\n        select_all_label.htmlFor = 'early_alert_filterform_select_all_checkbox';\n\n        let no_record = document.createElement('LABEL');\n        no_record.textContent = 'No records';\n        no_record.id = 'early_alert_filterform_li_nothing';\n\n        select_all_li.appendChild(select_all_checkbox);\n        select_all_li.appendChild(select_all_label);\n        ulElement.appendChild(select_all_li);\n        let i = 0;\n\n        let student_ids_selected = document.querySelector('input[name=\"student_ids\"]') || {};\n        student_ids_selected.value = [];\n        // Create an unordered list for each grade\n        results.forEach((item) => {\n\n            // Create a new list item (LI) element\n            let li = document.createElement('LI');\n            let checkbox = document.createElement('INPUT');\n            checkbox.type = 'checkbox';\n            checkbox.className = 'early_alert_filterform_checkbox';\n            checkbox.id = `early_alert_filterform_checkbox_${i}`;\n            checkbox.setAttribute('user_id', item.id);\n\n            // Add the checkbox to the list item (LI)\n            li.appendChild(checkbox);\n\n            // Create a div for column 1\n            let col1Div = document.createElement('DIV');\n            col1Div.className = 'column1';\n\n            // Create a label for the checkbox\n            let label = document.createElement('LABEL');\n            label.textContent = item.idnumber + ' | ' + item.first_name + ' ' + item.last_name;\n            label.htmlFor = `early_alert_filterform_checkbox_${i}`;\n\n            // Add the label to column 1 div\n            col1Div.appendChild(checkbox);\n            col1Div.appendChild(label);\n\n            // Add column 1 div to list item (LI)\n            li.appendChild(col1Div);\n\n            // Create a div for column 2\n            let col2Div = document.createElement('DIV');\n            col2Div.className = 'column2';\n\n            // Create a span for the pill element\n            let pillSpan = document.createElement('SPAN');\n            pillSpan.className = 'pill red';\n            pillSpan.textContent = item.grade;\n            pillSpan.id = `early_alert_filterform_grade_pill_${i}`;\n            pillSpan.style.display = 'none';\n\n            // Add the pill to column 2 div\n            col2Div.appendChild(pillSpan);\n\n            // Create another span for the value text\n            let valueSpan = document.createElement('SPAN');\n            valueSpan.className = 'value-text';\n\n            // Add the value text to column 2 div\n            col2Div.appendChild(valueSpan);\n\n            // Add column 2 div to list item (LI)\n            li.appendChild(col2Div);\n            ulElement.appendChild((li));\n            i++;\n        });\n        students_gradesList.appendChild(ulElement);\n\n        // Add an event listener to the select all checkbox\n        select_all_checkbox.addEventListener('change', function() {\n            // Get all checkboxes within the list\n            let checkboxes = document.querySelectorAll(\"input[class^='early_alert_filterform_checkbox']\");\n            // Loop through each checkbox and toggle its selection based on the state of the select all checkbox\n            checkboxes.forEach(function(checkbox) {\n                if (select_all_checkbox.checked) {\n                    checkbox.checked = true;\n                    selected_students.push(checkbox.getAttribute('user_id'));\n                } else {\n                    checkbox.checked = false;\n                    selected_students = selected_students.filter(item => item !== checkbox.getAttribute('user_id'));\n                }\n            });\n            student_ids_selected.value = JSON.stringify(selected_students);\n\n        });\n        // search dom for checkboxes and add to checked list\n        let grade_checkboxes = document.querySelectorAll(\"input[class^='early_alert_filterform_checkbox']\");\n        // Loop through each checkbox and toggle its selection based on the state of the select all checkbox\n        grade_checkboxes.forEach(function(checkbox) {\n            checkbox.addEventListener('click', function() {\n                if (checkbox.checked) {\n                    selected_students.push(checkbox.getAttribute('user_id'));\n                } else {\n                    selected_students = selected_students.filter(item => item !== checkbox.getAttribute('user_id'));\n                }\n                student_ids_selected.value = JSON.stringify(selected_students);\n            });\n\n        });\n        show_grades();\n    }).fail(function (e) {\n\n        alert(e);\n        // fail gracefully somehow :'( ;\n    });\n}\n\nfunction show_grades() {\n    // check box for grade showing - remove later\n    const show_grade_checkbox = document.getElementById('id_early_alert_filter_grade_chk');\n    // check box for grade showing - remove later\n    show_grade_checkbox.addEventListener('click', function() {\n        let grade_pills = document.querySelectorAll(\"span.pill\");\n        grade_pills.forEach(function (grade_pill) {\n        if (show_grade_checkbox.checked) {\n            if (grade_pill.style.display == 'none') {\n                grade_pill.style.display = 'block';\n            }\n        }\n        else {\n            grade_pill.style.display = 'none';}\n        });\n    });\n}"],"names":["setup_filter_students_by_grade","course_id","$grade_letter_id","selected_students","ajax","call","methodname","args","id","grade_letter_id","done","results","students_gradesList","document","getElementById","innerHTML","ulElement","createElement","select_all_checkbox","type","className","select_all_li","select_all_label","textContent","htmlFor","no_record","appendChild","i","student_ids_selected","querySelector","value","forEach","item","li","checkbox","setAttribute","col1Div","label","idnumber","first_name","last_name","col2Div","pillSpan","grade","style","display","valueSpan","addEventListener","querySelectorAll","checked","push","getAttribute","filter","JSON","stringify","show_grade_checkbox","grade_pill","show_grades","fail","e","alert","selected_grade","getElementsByName","filter_students_by_grade"],"mappings":"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"}