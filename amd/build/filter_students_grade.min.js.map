{"version":3,"file":"filter_students_grade.min.js","sources":["../src/filter_students_grade.js"],"sourcesContent":["import ajax from 'core/ajax';\nexport const init = () => {\n    filter_students_by_grade();\n};\n\n/**\n * Adds students with grades\n */\nfunction filter_students_by_grade() {\n\n    // Get the s delected grade value from the dropdown\n    const selected_grade = document.getElementById('id_early_alert_filter_grade_select');\n    let $grade_letter_id = 0;\n    const course_id = document.getElementsByName('early_alert_filter_course_id')[0].value;\n    setup_filter_students_by_grade(course_id, $grade_letter_id);\n\n    selected_grade.addEventListener('change', function() {\n        $grade_letter_id = selected_grade.value;\n        setup_filter_students_by_grade(course_id, $grade_letter_id);\n    });\n\n}\n\n/**\n *  Filter your data based on the selected grade value (for example)\n * @param course_id\n * @param $grade_letter_id\n */\nfunction setup_filter_students_by_grade(course_id, $grade_letter_id) {\n    var get_filtered_studentgrades = ajax.call([{\n        methodname: 'earlyalert_course_grades_percent_get',\n        args: {\n            id: course_id,\n            grade_letter_id: $grade_letter_id\n        }\n    }]);\n    get_filtered_studentgrades[0].done(function (results) {\n        //results.filter(item => item.grade === parseInt(selectedGrade));\n        //let t = selectedGrade;\n        // Update your page with the filtered data\n        const students_gradesList = document.getElementById('early_alert_filter_students_container');\n        students_gradesList.innerHTML = '';\n        const ulElement = document.createElement('ul');\n\n        let select_all_checkbox = document.createElement('INPUT');\n        select_all_checkbox.type = 'checkbox';\n        select_all_checkbox.className = 'early_alert_filterform_select_all_checkbox';\n        select_all_checkbox.id = 'early_alert_filterform_select_all_checkbox_0';\n\n        let select_all_li = document.createElement('LI');\n\n        // Create a label for the select allcheckbox\n        let select_all_label = document.createElement('LABEL');\n        select_all_label.textContent = 'Select All/None';\n        select_all_label.htmlFor = 'early_alert_filterform_select_all_checkbox';\n\n        select_all_li.appendChild(select_all_checkbox);\n        select_all_li.appendChild(select_all_label);\n        ulElement.appendChild(select_all_li);\n        let i = 0;\n        let selected_students = [];\n        let student_ids_selected = document.querySelector('input[name=\"student_ids\"]') || {};\n        // Create an unordered list for each grade\n        results.forEach((item) => {\n\n            // Create a new list item (LI) element\n            let li = document.createElement('LI');\n            let checkbox = document.createElement('INPUT');\n            checkbox.type = 'checkbox';\n            checkbox.className = 'early_alert_filterform_checkbox';\n            checkbox.id = `early_alert_filterform_checkbox_${i}`;\n            checkbox.setAttribute('user_id', item.id);\n\n            // Add the checkbox to the list item (LI)\n            li.appendChild(checkbox);\n\n            // Create a div for column 1\n            let col1Div = document.createElement('DIV');\n            col1Div.className = 'column1';\n\n            // Create a label for the checkbox\n            let label = document.createElement('LABEL');\n            label.textContent = item.first_name + ' ' + item.last_name;\n            label.htmlFor = `early_alert_filterform_checkbox_${i}`;\n\n            // Add the label to column 1 div\n            col1Div.appendChild(checkbox);\n            col1Div.appendChild(label);\n\n            // Add column 1 div to list item (LI)\n            li.appendChild(col1Div);\n\n            // Create a div for column 2\n            let col2Div = document.createElement('DIV');\n            col2Div.className = 'column2';\n\n            // Create a span for the pill element\n            let pillSpan = document.createElement('SPAN');\n            pillSpan.className = 'pill red';\n            pillSpan.textContent = '5'; // move to css\n            pillSpan.textContent = item.grade;\n\n            // Add the pill to column 2 div\n            col2Div.appendChild(pillSpan);\n\n            // Create another span for the value text\n            let valueSpan = document.createElement('SPAN');\n            valueSpan.className = 'value-text';\n            valueSpan.textContent = '!';\n\n            // Add the value text to column 2 div\n            col2Div.appendChild(valueSpan);\n\n            // Add column 2 div to list item (LI)\n            li.appendChild(col2Div);\n            ulElement.appendChild((li));\n            i++;\n        });\n        students_gradesList.appendChild(ulElement);\n\n        // Add an event listener to the select all checkbox\n        select_all_checkbox.addEventListener('change', function() {\n            // Get all checkboxes within the list\n            let checkboxes = document.querySelectorAll(\"input[class^='early_alert_filterform_checkbox']\");\n            // Loop through each checkbox and toggle its selection based on the state of the select all checkbox\n            checkboxes.forEach(function(checkbox) {\n                if (select_all_checkbox.checked) {\n                    checkbox.checked = true;\n                    selected_students.push(checkbox.getAttribute('user_id'));\n                } else {\n                    checkbox.checked = false;\n                    selected_students = selected_students.filter(item => item !== checkbox.getAttribute('user_id'));\n                }\n            });\n            student_ids_selected.value = JSON.stringify(selected_students);\n\n        });\n        // search dom for checkboxes and add to checked list\n        let grade_checkboxes = document.querySelectorAll(\"input[class^='early_alert_filterform_checkbox']\");\n        // Loop through each checkbox and toggle its selection based on the state of the select all checkbox\n        grade_checkboxes.forEach(function(checkbox) {\n            checkbox.addEventListener('click', function() {\n                if (checkbox.checked) {\n                    selected_students.push(checkbox.getAttribute('user_id'));\n                } else {\n                    selected_students = selected_students.filter(item => item !== checkbox.getAttribute('user_id'));\n                }\n                student_ids_selected.value = JSON.stringify(selected_students);\n            });\n\n        });\n    }).fail(function (e) {\n\n        alert(e);\n        // fail gracefully somehow :'( ;\n    });\n}"],"names":["setup_filter_students_by_grade","course_id","$grade_letter_id","ajax","call","methodname","args","id","grade_letter_id","done","results","students_gradesList","document","getElementById","innerHTML","ulElement","createElement","select_all_checkbox","type","className","select_all_li","select_all_label","textContent","htmlFor","appendChild","i","selected_students","student_ids_selected","querySelector","forEach","item","li","checkbox","setAttribute","col1Div","label","first_name","last_name","col2Div","pillSpan","grade","valueSpan","addEventListener","querySelectorAll","checked","push","getAttribute","filter","value","JSON","stringify","fail","e","alert","selected_grade","getElementsByName","filter_students_by_grade"],"mappings":"oPA4BSA,+BAA+BC,UAAWC,kBACdC,cAAKC,KAAK,CAAC,CACxCC,WAAY,uCACZC,KAAM,CACFC,GAAIN,UACJO,gBAAiBN,qBAGE,GAAGO,MAAK,SAAUC,eAInCC,oBAAsBC,SAASC,eAAe,yCACpDF,oBAAoBG,UAAY,SAC1BC,UAAYH,SAASI,cAAc,UAErCC,oBAAsBL,SAASI,cAAc,SACjDC,oBAAoBC,KAAO,WAC3BD,oBAAoBE,UAAY,6CAChCF,oBAAoBV,GAAK,mDAErBa,cAAgBR,SAASI,cAAc,MAGvCK,iBAAmBT,SAASI,cAAc,SAC9CK,iBAAiBC,YAAc,kBAC/BD,iBAAiBE,QAAU,6CAE3BH,cAAcI,YAAYP,qBAC1BG,cAAcI,YAAYH,kBAC1BN,UAAUS,YAAYJ,mBAClBK,EAAI,EACJC,kBAAoB,GACpBC,qBAAuBf,SAASgB,cAAc,8BAAgC,GAElFlB,QAAQmB,SAASC,WAGTC,GAAKnB,SAASI,cAAc,MAC5BgB,SAAWpB,SAASI,cAAc,SACtCgB,SAASd,KAAO,WAChBc,SAASb,UAAY,kCACrBa,SAASzB,6CAAwCkB,GACjDO,SAASC,aAAa,UAAWH,KAAKvB,IAGtCwB,GAAGP,YAAYQ,cAGXE,QAAUtB,SAASI,cAAc,OACrCkB,QAAQf,UAAY,cAGhBgB,MAAQvB,SAASI,cAAc,SACnCmB,MAAMb,YAAcQ,KAAKM,WAAa,IAAMN,KAAKO,UACjDF,MAAMZ,kDAA6CE,GAGnDS,QAAQV,YAAYQ,UACpBE,QAAQV,YAAYW,OAGpBJ,GAAGP,YAAYU,aAGXI,QAAU1B,SAASI,cAAc,OACrCsB,QAAQnB,UAAY,cAGhBoB,SAAW3B,SAASI,cAAc,QACtCuB,SAASpB,UAAY,WACrBoB,SAASjB,YAAc,IACvBiB,SAASjB,YAAcQ,KAAKU,MAG5BF,QAAQd,YAAYe,cAGhBE,UAAY7B,SAASI,cAAc,QACvCyB,UAAUtB,UAAY,aACtBsB,UAAUnB,YAAc,IAGxBgB,QAAQd,YAAYiB,WAGpBV,GAAGP,YAAYc,SACfvB,UAAUS,YAAaO,IACvBN,OAEJd,oBAAoBa,YAAYT,WAGhCE,oBAAoByB,iBAAiB,UAAU,WAE1B9B,SAAS+B,iBAAiB,mDAEhCd,SAAQ,SAASG,UACpBf,oBAAoB2B,SACpBZ,SAASY,SAAU,EACnBlB,kBAAkBmB,KAAKb,SAASc,aAAa,cAE7Cd,SAASY,SAAU,EACnBlB,kBAAoBA,kBAAkBqB,QAAOjB,MAAQA,OAASE,SAASc,aAAa,iBAG5FnB,qBAAqBqB,MAAQC,KAAKC,UAAUxB,sBAIzBd,SAAS+B,iBAAiB,mDAEhCd,SAAQ,SAASG,UAC9BA,SAASU,iBAAiB,SAAS,WAC3BV,SAASY,QACTlB,kBAAkBmB,KAAKb,SAASc,aAAa,YAE7CpB,kBAAoBA,kBAAkBqB,QAAOjB,MAAQA,OAASE,SAASc,aAAa,aAExFnB,qBAAqBqB,MAAQC,KAAKC,UAAUxB,4BAIrDyB,MAAK,SAAUC,GAEdC,MAAMD,oBAxJM,uBAUVE,eAAiB1C,SAASC,eAAe,0CAC3CX,iBAAmB,QACjBD,UAAYW,SAAS2C,kBAAkB,gCAAgC,GAAGP,MAChFhD,+BAA+BC,UAAWC,kBAE1CoD,eAAeZ,iBAAiB,UAAU,WACtCxC,iBAAmBoD,eAAeN,MAClChD,+BAA+BC,UAAWC,qBAhB9CsD"}