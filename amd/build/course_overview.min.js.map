{"version":3,"file":"course_overview.min.js","sources":["../src/course_overview.js"],"sourcesContent":["import ajax from 'core/ajax';\nimport Templates from 'core/templates';\nimport {get_string as getString} from 'core/str';\n\nexport const init = () => {\n    observeCourseOverviewButtons();\n};\n\n// add mutation observer that lets us know when the course overview buttons are added to the page\nfunction observeCourseOverviewButtons() {\n    const targetNode = document.getElementById('early-alert-student-results');\n    const config = { childList: true, subtree: true };\n\n    const callback = function(mutationsList, observer) {\n        for (let mutation of mutationsList) {\n            if (mutation.type === 'childList') {\n                addCourseOverviewButtonListener();\n            }\n        }\n    };\n\n    const observer = new MutationObserver(callback);\n    observer.observe(targetNode, config);\n\n    // Initial call to add listeners to existing buttons\n    addCourseOverviewButtonListener();\n}\n\nfunction addCourseOverviewButtonListener() {\n    // find all buttons with class btn-course-overview\n    // Get the course id from the button data-course-id attribute\n    // Call the ajax function with the course id\n    // Display the students in the course\n    const courseOverviewButtons = document.querySelectorAll('.btn-course-overview');\n    courseOverviewButtons.forEach(button => {\n        button.addEventListener('click', function() {\n            const courseId = this.getAttribute('data-course_id');\n            //Show loader\n            Templates.render('local_earlyalert/loader', {})\n                .then(function (html, js) {\n                    // Insert the rendered template into the target element\n                    document.getElementById('early-alert-student-results').innerHTML = html;\n                    Templates.runTemplateJS(js);\n                })\n                .catch(function (error) {\n                    console.error('Failed to render template:', error);\n                });\n\n            // Make ajax call to get the students in the course\n            ajax.call([{\n                methodname: 'earlyalert_course_overview',\n                args: {\n                    id: courseId\n                }\n            }])[0].then(function (response) {\n                console.log(response);\n                // Hide loader\n                // Render the course overview template\n                Templates.render('local_earlyalert/course_overview', response)\n                    .then(function (html, js) {\n                        // Insert the rendered template into the target element\n                        document.getElementById('early-alert-student-results').innerHTML = html;\n                        Templates.runTemplateJS(js);\n                    })\n                    .catch(function (error) {\n                        console.error('Failed to render template:', error);\n                    });\n            }).catch(function (error) {\n                console.error('Failed to get course students:', error);\n            });\n        });\n    });\n}"],"names":["addCourseOverviewButtonListener","document","querySelectorAll","forEach","button","addEventListener","courseId","this","getAttribute","render","then","html","js","getElementById","innerHTML","runTemplateJS","catch","error","console","call","methodname","args","id","response","log","targetNode","config","childList","subtree","MutationObserver","mutationsList","observer","mutation","type","observe","observeCourseOverviewButtons"],"mappings":"kYA4BSA,kCAKyBC,SAASC,iBAAiB,wBAClCC,SAAQC,SAC1BA,OAAOC,iBAAiB,SAAS,iBACvBC,SAAWC,KAAKC,aAAa,qCAEzBC,OAAO,0BAA2B,IACvCC,MAAK,SAAUC,KAAMC,IAElBX,SAASY,eAAe,+BAA+BC,UAAYH,wBACzDI,cAAcH,OAE3BI,OAAM,SAAUC,OACbC,QAAQD,MAAM,6BAA8BA,wBAI/CE,KAAK,CAAC,CACPC,WAAY,6BACZC,KAAM,CACFC,GAAIhB,aAER,GAAGI,MAAK,SAAUa,UAClBL,QAAQM,IAAID,6BAGFd,OAAO,mCAAoCc,UAChDb,MAAK,SAAUC,KAAMC,IAElBX,SAASY,eAAe,+BAA+BC,UAAYH,wBACzDI,cAAcH,OAE3BI,OAAM,SAAUC,OACbC,QAAQD,MAAM,6BAA8BA,aAErDD,OAAM,SAAUC,OACfC,QAAQD,MAAM,iCAAkCA,8BAhE5C,uBAMVQ,WAAaxB,SAASY,eAAe,+BACrCa,OAAS,CAAEC,WAAW,EAAMC,SAAS,GAU1B,IAAIC,kBARJ,SAASC,cAAeC,cAChC,IAAIC,YAAYF,cACK,cAAlBE,SAASC,MACTjC,qCAMHkC,QAAQT,WAAYC,QAG7B1B,kCApBAmC"}